<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="author" content="CodePel">
      <title> Upload crop & save Example </title>
      <!-- Style CSS -->

<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/cropper/2.3.4/cropper.min.css'>

<style>
	.result { max-width: 400px; max-height: 400px; background-color: #f30; }
</style>
   </head>
   <body> 

 
		<input type="file" id="file-input">
		<div class="result"></div>



	<!--rightbox-->
	<div class="box-2 img-result hide">
		<img class="cropped" src="" alt="">
	</div>

 
	<div class="box">
		<input type="hidden" class="img-w" value="300" min="100" max="1200" />
		<button class="btn save hide">Save</button>
		<a href="" class="btn download hide">Download</a>
	</div>



 
<script src='https://cdnjs.cloudflare.com/ajax/libs/cropperjs/0.8.1/cropper.min.js'></script>
<script>
	// vars
	let result = document.querySelector('.result'),
	img_result = document.querySelector('.img-result'),
	img_w = document.querySelector('.img-w'),
	img_h = document.querySelector('.img-h'),
//	options = document.querySelector('.options'),
	save = document.querySelector('.save'),
	cropped = document.querySelector('.cropped'),
	dwn = document.querySelector('.download'),
	upload = document.querySelector('#file-input'),
	cropper = '';
	
	// on change show image with crop options
	upload.addEventListener('change', e => {
	  if (e.target.files.length) {
		// start file reader
		const reader = new FileReader();
		reader.onload = e => {
		  if (e.target.result) {
			// create new image
			let img = document.createElement('img');
			img.id = 'image';
			img.src = e.target.result;
			// clean result before
			result.innerHTML = '';
			// append new image
			result.appendChild(img);
			// show save btn and options
			save.classList.remove('hide');
		//	options.classList.remove('hide');
			// init cropper
			cropper = new Cropper(img);
		  }
		};
		reader.readAsDataURL(e.target.files[0]);
	  }
	});
	
	// save on click
	save.addEventListener('click', e => {
	  e.preventDefault();
	  let imgSrc = cropper.getCroppedCanvas({
		width: img_w.value // input value
	  }).toDataURL();
	  cropped.classList.remove('hide');
	  img_result.classList.remove('hide');
	  // show image cropped
	  cropped.src = imgSrc;
	  result.style.display ='none';
	  dwn.classList.remove('hide');
	  dwn.download = 'imagename.png';
	  dwn.setAttribute('href', imgSrc);
	  console.log(imgSrc);
	});
	</script>



</body>
</html>